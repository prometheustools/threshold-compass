<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Signal Constellation Lab</title>
    <style>
      :root {
        --bg: #0a0a0a;
        --surface: #121212;
        --elevated: #1e1e1e;
        --border: #8b4d2c55;
        --ivory: #f5f2e9;
        --bone: #c4c0b6;
        --ash: #8a8a8a;
        --orange: #e07a3e;
        --clear: #4a9b6b;
        --mild: #c9a227;
        --elevated: #b54a4a;
      }
      body { background:var(--bg); color:var(--ivory); font-family: ui-monospace, SFMono-Regular, Menlo, monospace; margin:0; line-height:1.5; }
      .wrap { max-width: 1100px; margin: 24px auto; padding: 0 16px; }
      h1 { font-size: 1.25rem; font-weight: 400; letter-spacing: 0.1em; text-transform: uppercase; color: var(--bone); margin: 0 0 20px 0; }
      .card { background:var(--surface); border:1px solid var(--border); border-radius:10px; padding:16px; margin-bottom:16px; }
      .controls { display: flex; flex-wrap: wrap; gap: 12px; align-items: center; }
      .controls label { display: flex; align-items: center; gap: 6px; color: var(--bone); font-size: 0.75rem; }
      .controls select, .controls input[type="range"] { background:var(--elevated); color:var(--ivory); border:1px solid var(--border); border-radius:6px; padding:6px 10px; font-size: 0.8rem; }
      .controls input[type="range"] { width: 100px; padding: 0; }
      canvas { width:100%; height:450px; background:#090909; border-radius:8px; border:1px solid #2a2a2a; cursor: crosshair; }
      .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; }
      .stat-box { background:var(--elevated); border-radius:8px; padding: 12px; }
      .stat-label { font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--ash); }
      .stat-value { font-size: 1.5rem; font-weight: 600; margin-top: 4px; }
      .stat-value.green { color: var(--clear); }
      .stat-value.yellow { color: var(--mild); }
      .stat-value.red { color: var(--elevated); }
      .legend { display: flex; gap: 16px; margin-top: 12px; flex-wrap: wrap; }
      .legend-item { display: flex; align-items: center; gap: 6px; font-size: 0.7rem; color: var(--bone); }
      .legend-dot { width: 10px; height: 10px; border-radius: 50%; }
      .tooltip { position: fixed; background: var(--elevated); border: 1px solid var(--border); border-radius: 8px; padding: 10px 14px; font-size: 0.75rem; pointer-events: none; opacity: 0; transition: opacity 0.15s; z-index: 100; max-width: 220px; }
      .tooltip.visible { opacity: 1; }
      .tooltip-row { display: flex; justify-content: space-between; gap: 16px; }
      .tooltip-label { color: var(--ash); }
      .tooltip-value { color: var(--ivory); }
      .config-row { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin-top: 8px; }
      .config-item { background: var(--elevated); border-radius: 6px; padding: 8px; text-align: center; }
      .config-label { font-size: 0.6rem; text-transform: uppercase; color: var(--ash); }
      .config-val { font-size: 0.85rem; color: var(--orange); margin-top: 2px; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <h1>Signal Constellation Lab</h1>
      
      <div class="card">
        <div class="controls">
          <label>Profile:
            <select id="fixture"></select>
          </label>
          <label>Show: 
            <select id="viewMode">
              <option value="effective">Effective Dose</option>
              <option value="signal">Signal Score</option>
              <option value="interference">Interference</option>
              <option value="carryover">Carryover</option>
            </select>
          </label>
          <label><input type="checkbox" id="showTrend" checked> Trend</label>
          <label><input type="checkbox" id="showZones" checked> Zones</label>
          <button id="reload" style="background:var(--orange); color:var(--bg); border:none; padding:8px 16px; border-radius:6px; cursor:pointer; font-weight:600;">Regenerate</button>
        </div>
        <div class="config-row" id="configRow"></div>
      </div>

      <div class="card">
        <canvas id="constellation" width="1050" height="450"></canvas>
        <div class="legend">
          <div class="legend-item"><div class="legend-dot" style="background:#4a9b6b"></div> Optimal</div>
          <div class="legend-item"><div class="legend-dot" style="background:#c9a227"></div> Caution</div>
          <div class="legend-item"><div class="legend-dot" style="background:#b54a4a"></div> Too High</div>
          <div class="legend-item"><div class="legend-dot" style="background:#8a8a8a"></div> Unclassified</div>
        </div>
      </div>

      <div class="stats-grid" id="stats"></div>
    </div>

    <div class="tooltip" id="tooltip"></div>
    <script src="viewer.js"></script>
  </body>
</html>
